CREATE TABLE MERCHANT (
  MERCHANT_ID VARCHAR(255) NOT NULL,
  EMAIL VARCHAR(255) NOT NULL,
  NAME VARCHAR(255) NOT NULL,
  ADDRESS TEXT NOT NULL,
  PHONE VARCHAR(255) NOT NULL,
  PRIMARY KEY (MERCHANT_ID)
);

CREATE TABLE USER (
  USER_ID VARCHAR(255) NOT NULL,
  EMAIL VARCHAR(255) NOT NULL,
  NAME VARCHAR(255) NOT NULL,
  ADDRESS TEXT NOT NULL,
  PHONE VARCHAR(255) NOT NULL,
  PRIMARY KEY (USER_ID)
);

CREATE TABLE PAYMENT (
  PAYMENT_ID VARCHAR(255) NOT NULL,
  PRIMARY KEY (PAYMENT_ID)
);

CREATE TABLE ORDERITEM (
  ORDERITEM_ID VARCHAR(255) NOT NULL,
  EMAIL VARCHAR(255) NOT NULL,
  ADDRESS TEXT NOT NULL,
  PHONE VARCHAR(255) NOT NULL,
  TOTALPRICE FLOAT NOT NULL,
  PAYMENT_ID VARCHAR(255),
  CREATED TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,
  PRIMARY KEY (ORDERITEM_ID),
  FOREIGN KEY (PAYMENT_ID) REFERENCES PAYMENT(PAYMENT_ID) ON DELETE RESTRICT ON UPDATE RESTRICT
);

CREATE TABLE PRODUCT (
  PRODUCT_ID VARCHAR(255) NOT NULL,
  TITLE VARCHAR(255) NOT NULL,
  DESCRIPTION TEXT NOT NULL,
  SELLINGPRICE FLOAT NOT NULL,
  DISCOUNTEDPRICE FLOAT NOT NULL,
  COSTPRICE FLOAT NOT NULL,
  CREATED TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,
  PRIMARY KEY (PRODUCT_ID)
);

CREATE TABLE PRODUCT_QUANTITY (
  PRODUCT_ID VARCHAR(255) NOT NULL,
  QUANTITYAVAILABLE INTEGER,
  PRIMARY KEY (PRODUCT_ID, QUANTITYAVAILABLE),
  FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCT(PRODUCT_ID) ON DELETE CASCADE ON UPDATE RESTRICT
);


CREATE TABLE PRODUCT_MERCHANT (
  PRODUCT_ID VARCHAR(255) NOT NULL,
  MERCHANT_ID VARCHAR(255) NOT NULL,
  PRIMARY KEY (PRODUCT_ID, MERCHANT_ID),
  FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCT(PRODUCT_ID) ON DELETE CASCADE ON UPDATE RESTRICT,
  FOREIGN KEY (MERCHANT_ID) REFERENCES MERCHANT(MERCHANT_ID) ON DELETE CASCADE ON UPDATE RESTRICT
);

CREATE TABLE PRODUCT_ORDERITEM (
  PRODUCT_ID VARCHAR(255) NOT NULL,
  ORDERITEM_ID VARCHAR(255) NOT NULL,
  QUANTITY INTEGER NOT NULL,
  PRIMARY KEY (PRODUCT_ID, ORDERITEM_ID),
  FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCT(PRODUCT_ID) ON DELETE CASCADE ON UPDATE RESTRICT,
  FOREIGN KEY (ORDERITEM_ID) REFERENCES ORDERITEM(ORDERITEM_ID) ON DELETE CASCADE ON UPDATE RESTRICT
);

CREATE TABLE PRODUCT_MEDIA (
  PRODUCT_ID VARCHAR(255) NOT NULL,
  FILENAME VARCHAR(255) NOT NULL,
  PRIMARY KEY (PRODUCT_ID, FILENAME),
  FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCT(PRODUCT_ID) ON DELETE CASCADE ON UPDATE RESTRICT
);

CREATE TABLE PRODUCT_COLLECTION (
  PRODUCT_ID VARCHAR(255) NOT NULL,
  COLLECTION_ID VARCHAR(255) NOT NULL,
  PRIMARY KEY (PRODUCT_ID, COLLECTION_ID),
  FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCT(PRODUCT_ID) ON DELETE CASCADE ON UPDATE RESTRICT
);
